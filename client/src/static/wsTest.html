<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket Chat Client</title>
</head>

<body>
<input type="text" id="messageInput" placeholder="输入消息">
<button id="sendButton">发送</button>
<div id="messageBox"></div>
<script>
    // 创建WebSocket对象，这里假设服务器运行在本地8080端口，服务端点路径是 /chat，你需要根据实际情况修改
    let ws = new WebSocket('ws://localhost:8080/chat');

    // 连接建立时触发
    ws.onopen = function () {
        console.log('WebSocket连接已建立');
        // 可以在这里发送初始消息，比如向服务器表明身份等，此处先不发送额外内容
    };

    // 接收服务器消息时触发
    ws.onmessage = function (event) {
        const messageDiv = document.createElement('div');
        messageDiv.textContent = `收到消息: ${event.data}`;
        document.getElementById('messageBox').appendChild(messageDiv);
    };

    // 连接出错时触发
    ws.onerror = function (error) {
        console.log('WebSocket连接出错:', error);
        const errorDiv = document.createElement('div');
        errorDiv.textContent = `连接出错: ${error}`;
        document.getElementById('messageBox').appendChild(errorDiv);
    };

    // 连接关闭时触发
    ws.onclose = function () {
        console.log('WebSocket连接已关闭');
        const closeDiv = document.createElement('div');
        closeDiv.textContent = '连接已关闭';
        document.getElementById('messageBox').appendChild(closeDiv);
    };

    // 获取发送按钮元素
    const sendButton = document.getElementById('sendButton');
    // 获取输入框元素
    const messageInput = document.getElementById('messageInput');

    // 为发送按钮添加点击事件监听器
    sendButton.addEventListener('click', function () {
        const message = messageInput.value;
        if (message.trim()!== '') {
            // 向服务器发送消息
            ws.send(message);
            const sentDiv = document.createElement('div');
            sentDiv.textContent = `已发送消息: ${message}`;
            document.getElementById('messageBox').appendChild(sentDiv);
            messageInput.value = '';
        }
    });
</script>
</body>

</html>